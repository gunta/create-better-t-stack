import { Show } from "solid-js";
import { useAuth } from "@/lib/auth-client";
import { User } from "lucide-solid";

export function UserMenu() {
  const { user, signOut, isLoading } = useAuth();

  return (
    <Show when={!isLoading()} fallback={<div class="animate-spin h-4 w-4 border-2 border-current border-t-transparent rounded-full" />}>
      <Show when={user()}>
        <div class="dropdown dropdown-end">
          <button class="btn btn-ghost btn-circle" tabindex="0">
            <User size={16} />
            <span class="sr-only">User menu</span>
          </button>
          <ul class="dropdown-content z-[1] menu p-2 shadow bg-base-100 rounded-box w-52">
            <li class="menu-title">My Account</li>
            <li>
              <button onClick={() => signOut()}>
                Sign out
              </button>
            </li>
          </ul>
        </div>
      </Show>
    </Show>
  );
}